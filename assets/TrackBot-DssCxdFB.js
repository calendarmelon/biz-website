import{d as w,j as e,f as te}from"./index-D9lviF5g.js";import{a as _}from"./vendor-CMvHcHbC.js";import{b as P}from"./index.esm-D2KpNuWo.js";import{c as y,d as I,e as E}from"./CForm-CDI_MHaX.js";import{a as re,b as ie,c as V}from"./CRow-DI1SHk01.js";import{Q as be,C as g,v as ye,w as D,x as A,y as Ce,z as q,n as Ne,o as ke,p as Se,q as Te,R as Be}from"./DefaultLayout-C9XncwlP.js";import{c as De}from"./cil-check-circle-BlU9eaow.js";import{C as ee}from"./CCardHeader-RgXls4u9.js";import{C as U,a as L}from"./CProgress-CSxi7xnY.js";import{C,a as N,b as p,c as o,d as k,e as i}from"./CTable-Cd-Ry0JT.js";import"./redux-IAqEd8mO.js";import"./staff-CasMKpZ_.js";import"./storage-DBNGZGiS.js";import"./cil-user-Ddrdy7PS.js";var Ae=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M496.059,182.581l-.025-70.7-32,.012.017,48.172-66.288,23.779-45.729.007V152.887A96.554,96.554,0,0,0,329.92,91.3l43.129-43.413h42.84v-32H359.732L305.745,70.231a96.815,96.815,0,0,0-100.511-.554l-53.056-53.84-56.158.05.029,32,42.748-.038L180.824,90.5a96.564,96.564,0,0,0-22.79,62.39V183.88l-43.235.007L48,160.093V111.921H16v70.742l80.035,28.509.007,84.715H16.034v32h80.01v8.01a159.741,159.741,0,0,0,9.7,54.979L16.034,425.448v70.439h32V447.411l71.73-27.642a159.794,159.794,0,0,0,249.578,29.044A161.477,161.477,0,0,0,392.4,419.667l71.638,27.727v48.493h32V425.466L406.42,390.781a159.178,159.178,0,0,0,9.614-55.1v-7.794h80v-32h-80v-84.6ZM240,463.029C176.991,455.235,128.045,401.2,128.045,335.9l-.01-120.011,30,0v.007H240ZM190.034,183.875V152.887a65,65,0,0,1,130,0v30.968Zm194,151.849A128.282,128.282,0,0,1,272,462.979V215.887h80.032v-.036l32,0Z' class='ci-primary'/>"],qe=["512 512","<rect width='34.924' height='34.924' x='256' y='95.998' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M16,496H496V16H16ZM48,48H464V464H48Z' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M285.313,359.032a18.123,18.123,0,0,1-15.6,8.966,18.061,18.061,0,0,1-17.327-23.157l35.67-121.277A49.577,49.577,0,0,0,194.7,190.572l-11.718,28.234,29.557,12.266,11.718-28.235a17.577,17.577,0,0,1,33.1,11.7l-35.67,121.277A50.061,50.061,0,0,0,269.709,400a50.227,50.227,0,0,0,43.25-24.853l15.1-25.913-27.646-16.115Z' class='ci-primary'/>"],Me=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M265.614,206.387H456V16H424V149.887L397.863,123.75c-79.539-79.539-208.96-79.54-288.5,0s-79.539,208.96,0,288.5a204.232,204.232,0,0,0,288.5,0l-22.627-22.627c-67.063,67.063-176.182,67.063-243.244,0s-67.063-176.183,0-243.246,176.182-67.063,243.245,0l28.01,28.01H265.614Z' class='ci-primary'/>"],Pe=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M473.605,88.081c-1.352-.137-135.958-14.259-199.218-68.251L269.9,16H242.1l-4.488,3.83C174.464,73.727,39.744,87.944,38.4,88.081L24,89.532V104c0,89.133,14.643,165.443,43.523,226.813,38.105,80.973,100.1,133.669,184.267,156.623l4.21,1.148,4.21-1.148c84.165-22.954,146.162-75.65,184.267-156.623C473.357,269.443,488,193.133,488,104V89.532ZM455.87,118.113q-.237,12.789-.948,25.887H272V57.915C331.921,97.482,421.024,113.237,455.87,118.113ZM272,320H414.266A288.233,288.233,0,0,1,390.9,360H272Zm0-32V248H439.9a402.662,402.662,0,0,1-13.236,42.884V288Zm0-72V176H452.378c-1.4,13.307-3.256,26.682-5.639,40ZM56.13,118.113c34.846-4.876,123.949-20.631,183.87-60.2V450.224C94.012,398.389,58.492,245.387,56.13,118.113ZM272,450.224V392h92.347C340.049,416.7,309.708,436.836,272,450.224Z' class='ci-primary'/>"],Ie=["512 512","<rect width='32' height='176' x='240' y='176' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='240' y='384' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M274.014,16H237.986L16,445.174V496H496V445.174ZM464,464H48V452.959L256,50.826,464,452.959Z' class='ci-primary'/>"];const R=u=>u?(u.toLowerCase(),/googlebot|bingbot|slurp|duckduckbot|baiduspider|yandexbot|sogou|exabot/i.test(u)?{isBot:!0,botType:"search_engine",confidence:100}:/facebookexternalhit|twitterbot|linkedinbot|telegrambot|whatsapp|slack/i.test(u)?{isBot:!0,botType:"social_media",confidence:100}:/uptimerobot|pingdom|statuscake|site24x7|newrelic/i.test(u)?{isBot:!0,botType:"monitoring",confidence:100}:/selenium|puppeteer|playwright|headless|phantom|nightmare/i.test(u)?{isBot:!0,botType:"automation",confidence:95}:/python-requests|curl|wget|scrapy|beautifulsoup|mechanize|axios/i.test(u)?{isBot:!0,botType:"scraper",confidence:90}:/bot|crawler|spider|scraper/i.test(u)?{isBot:!0,botType:"generic_bot",confidence:85}:u.length<20?{isBot:!0,botType:"suspicious_short",confidence:70}:{isBot:!1,botType:null,confidence:0}):{isBot:!0,botType:"empty_ua",confidence:80},Ee=async({limit:u=100,startDate:h=null,endDate:a=null}={})=>{try{let d=w.from("app_page_views").select("user_agent, ip_address, session_id, viewed_at").or("user_agent.ilike.%bot%,user_agent.ilike.%crawler%,user_agent.ilike.%spider%,user_agent.ilike.%scraper%,user_agent.ilike.%curl%,user_agent.ilike.%wget%,user_agent.ilike.%python%,user_agent.ilike.%scrapy%,user_agent.ilike.%headless%");h&&(d=d.gte("viewed_at",h)),a&&(d=d.lte("viewed_at",a));const{data:n,error:c}=await d.order("viewed_at",{ascending:!1}).limit(u);if(c)throw c;const t=n.reduce((r,x)=>{const f=x.user_agent||"[EMPTY]";return r[f]||(r[f]={user_agent:f,count:0,unique_ips:new Set,unique_sessions:new Set,first_seen:x.viewed_at,last_seen:x.viewed_at}),r[f].count++,r[f].unique_ips.add(x.ip_address),r[f].unique_sessions.add(x.session_id),r[f].last_seen=x.viewed_at,r},{});return Object.values(t).map(r=>({...r,unique_ips:r.unique_ips.size,unique_sessions:r.unique_sessions.size,detection:R(r.user_agent)}))}catch(d){throw console.error("Error fetching known bots:",d),d}},Re=async({limit:u=50}={})=>{try{const{data:h,error:a}=await w.from("app_page_views").select("user_agent, session_id, ip_address, viewed_at, page_type").or("user_agent.ilike.%selenium%,user_agent.ilike.%puppeteer%,user_agent.ilike.%playwright%,user_agent.ilike.%headless%,user_agent.ilike.%phantom%").order("viewed_at",{ascending:!1}).limit(u);if(a)throw a;return h}catch(h){throw console.error("Error fetching automation tools:",h),h}},He=async({minLength:u=20,limit:h=100}={})=>{try{const{data:a,error:d}=await w.from("app_page_views").select("user_agent, ip_address, session_id, viewed_at").order("viewed_at",{ascending:!1}).limit(1e3);if(d)throw d;const c=a.filter(t=>!t.user_agent||t.user_agent.length<u).reduce((t,r)=>{const x=r.user_agent||"[EMPTY]";return t[x]||(t[x]={user_agent:x,count:0,unique_ips:new Set}),t[x].count++,t[x].unique_ips.add(r.ip_address),t},{});return Object.values(c).map(t=>({...t,unique_ips:t.unique_ips.size})).slice(0,h)}catch(a){throw console.error("Error fetching suspicious user agents:",a),a}},Ve=async({maxDuration:u=10,minPageCount:h=5}={})=>{try{const{data:a,error:d}=await w.from("app_page_views").select("session_id, user_agent, viewed_at, ip_address").gte("viewed_at",new Date(Date.now()-864e5).toISOString()).order("viewed_at",{ascending:!1});if(d)throw d;const n=a.reduce((t,r)=>(t[r.session_id]||(t[r.session_id]={session_id:r.session_id,user_agent:r.user_agent,ip_address:r.ip_address,views:[]}),t[r.session_id].views.push(new Date(r.viewed_at)),t),{}),c=[];return Object.values(n).forEach(t=>{if(t.views.length>=h){const r=t.views.sort((f,S)=>f-S),x=(r[r.length-1]-r[0])/1e3;x<u&&c.push({...t,page_count:t.views.length,duration_seconds:x,pages_per_second:t.views.length/x,detection:R(t.user_agent)})}}),c.sort((t,r)=>r.pages_per_second-t.pages_per_second)}catch(a){throw console.error("Error fetching superfast sessions:",a),a}},Ue=async({maxTime:u=2,limit:h=100}={})=>{try{const{data:a,error:d}=await w.from("app_page_views").select("user_agent, time_on_page, ip_address, viewed_at").lte("time_on_page",u).not("time_on_page","is",null).order("viewed_at",{ascending:!1}).limit(1e3);if(d)throw d;const n=a.reduce((c,t)=>{const r=t.user_agent||"[EMPTY]";return c[r]||(c[r]={user_agent:r,count:0,avg_time:0,total_time:0}),c[r].count++,c[r].total_time+=t.time_on_page,c},{});return Object.values(n).map(c=>({...c,avg_time:c.total_time/c.count,detection:R(c.user_agent)})).filter(c=>c.count>=10).sort((c,t)=>t.count-c.count).slice(0,h)}catch(a){throw console.error("Error fetching instant bounces:",a),a}},Le=async({minRepeat:u=50}={})=>{try{const{data:h,error:a}=await w.from("app_page_views").select("ip_address, user_agent, page_type, viewed_at").gte("viewed_at",new Date(Date.now()-6048e5).toISOString()).order("viewed_at",{ascending:!1});if(a)throw a;const d=h.reduce((n,c)=>{const t=`${c.ip_address}|${c.user_agent}|${c.page_type}`;return n[t]||(n[t]={ip_address:c.ip_address,user_agent:c.user_agent,page_type:c.page_type,repeat_count:0}),n[t].repeat_count++,n},{});return Object.values(d).filter(n=>n.repeat_count>=u).map(n=>({...n,detection:R(n.user_agent)})).sort((n,c)=>c.repeat_count-n.repeat_count)}catch(h){throw console.error("Error fetching repetitive patterns:",h),h}},Oe=async({minScore:u=80,limit:h=100}={})=>{try{const{data:a,error:d}=await w.from("app_page_views").select("session_id, user_agent, ip_address, referrer, time_on_page, viewed_at").gte("viewed_at",new Date(Date.now()-864e5).toISOString()).order("viewed_at",{ascending:!1});if(d)throw d;const n=a.reduce((t,r)=>(t[r.session_id]||(t[r.session_id]={session_id:r.session_id,user_agent:r.user_agent,ip_address:r.ip_address,referrer:r.referrer,views:[],time_on_pages:[]}),t[r.session_id].views.push(r.viewed_at),r.time_on_page!==null&&t[r.session_id].time_on_pages.push(r.time_on_page),t),{});return Object.values(n).map(t=>{let r=0;const x=R(t.user_agent);x.botType==="search_engine"||x.botType==="social_media"?r+=50:x.botType==="automation"||x.botType==="scraper"?r+=70:x.isBot&&(r+=60),(!t.user_agent||t.user_agent.length<20)&&(r+=30);const f=t.time_on_pages.length>0?t.time_on_pages.reduce((S,z)=>S+z,0)/t.time_on_pages.length:0;return f<2&&(r+=40),t.referrer||(r+=20),t.views.length>100&&(r+=30),{...t,view_count:t.views.length,avg_time_on_page:f,bot_score:r,detection:x}}).filter(t=>t.bot_score>=u).sort((t,r)=>r.bot_score-t.bot_score).slice(0,h)}catch(a){throw console.error("Error calculating bot scores:",a),a}},Ze=async({startDate:u=new Date(Date.now()-10080*60*1e3).toISOString(),endDate:h=new Date().toISOString()}={})=>{try{const{data:a,error:d}=await w.from("app_page_views").select("user_agent, time_on_page").gte("viewed_at",u).lte("viewed_at",h);if(d)throw d;const n={total_requests:a.length,human_traffic:0,search_engine_bots:0,social_media_bots:0,monitoring_bots:0,automation_tools:0,scrapers:0,suspicious:0,breakdown:{}};return a.forEach(c=>{const t=R(c.user_agent);if(!t.isBot)n.human_traffic++;else{switch(t.botType){case"search_engine":n.search_engine_bots++;break;case"social_media":n.social_media_bots++;break;case"monitoring":n.monitoring_bots++;break;case"automation":n.automation_tools++;break;case"scraper":n.scrapers++;break;default:n.suspicious++}const r=c.user_agent||"[EMPTY]";n.breakdown[r]||(n.breakdown[r]={count:0,botType:t.botType}),n.breakdown[r].count++}}),n.human_percentage=(n.human_traffic/n.total_requests*100).toFixed(2),n.bot_percentage=((n.total_requests-n.human_traffic)/n.total_requests*100).toFixed(2),n}catch(a){throw console.error("Error fetching bot traffic stats:",a),a}},ze=async({minCountries:u=2,maxHours:h=1}={})=>{try{const{data:a,error:d}=await w.from("app_page_views").select("visitor_id, user_agent, country_code, viewed_at").not("visitor_id","is",null).not("country_code","is",null).gte("viewed_at",new Date(Date.now()-6048e5).toISOString()).order("viewed_at",{ascending:!1});if(d)throw d;const n=a.reduce((t,r)=>(t[r.visitor_id]||(t[r.visitor_id]={visitor_id:r.visitor_id,user_agent:r.user_agent,countries:new Set,views:[]}),t[r.visitor_id].countries.add(r.country_code),t[r.visitor_id].views.push(new Date(r.viewed_at)),t),{}),c=[];return Object.values(n).forEach(t=>{if(t.countries.size>=u){const r=t.views.sort((f,S)=>f-S),x=(r[r.length-1]-r[0])/(1e3*60*60);x<=h&&c.push({visitor_id:t.visitor_id,user_agent:t.user_agent,countries_visited:Array.from(t.countries),time_span_hours:x.toFixed(2),detection:R(t.user_agent)})}}),c.sort((t,r)=>r.countries_visited.length-t.countries_visited.length)}catch(a){throw console.error("Error fetching geographic anomalies:",a),a}},Fe=async(u,{limit:h=100}={})=>{try{const{data:a,error:d}=await w.from("app_page_views").select("*").eq("user_agent",u).order("viewed_at",{ascending:!1}).limit(h);if(d)throw d;return a}catch(a){throw console.error("Error fetching detailed records by user agent:",a),a}},We=async u=>{try{const{data:h,error:a}=await w.from("app_page_views").select("*").eq("session_id",u).order("viewed_at",{ascending:!1});if(a)throw a;return h}catch(h){throw console.error("Error fetching detailed records by session:",h),h}},$e=async(u,{limit:h=100}={})=>{try{const{data:a,error:d}=await w.from("app_page_views").select("*").eq("visitor_id",u).order("viewed_at",{ascending:!1}).limit(h);if(d)throw d;return a}catch(a){throw console.error("Error fetching detailed records by visitor:",a),a}},Ge=async(u,h,a=null,{limit:d=100}={})=>{try{let n=w.from("app_page_views").select("*").eq("ip_address",u).eq("user_agent",h);a&&(n=n.eq("page_type",a));const{data:c,error:t}=await n.order("viewed_at",{ascending:!1}).limit(d);if(t)throw t;return c}catch(n){throw console.error("Error fetching detailed records by IP and UA:",n),n}},ls=()=>{const[u,h]=_.useState(!0),[a,d]=_.useState(null),[n,c]=_.useState("overview"),[t,r]=_.useState({total_requests:0,human_traffic:0,search_engine_bots:0,social_media_bots:0,monitoring_bots:0,automation_tools:0,scrapers:0,suspicious:0,human_percentage:0,bot_percentage:0,breakdown:{}}),[x,f]=_.useState([]),[S,z]=_.useState([]),[F,ne]=_.useState([]),[W,oe]=_.useState([]),[$,ae]=_.useState([]),[G,ce]=_.useState([]),[Y,le]=_.useState([]),[K,de]=_.useState([]),[he,H]=_.useState(!1),[ue,O]=_.useState(""),[J,b]=_.useState([]),[xe,B]=_.useState(!1);_.useEffect(()=>{se()},[]);const se=async()=>{h(!0),d(null);try{const[s,l,m,v,Z,_e,fe,ve,we]=await Promise.all([Ze(),Ee({limit:50}),Re({limit:30}),He({limit:30}),Ve({maxDuration:10,minPageCount:5}),Ue({maxTime:2,limit:30}),Le({minRepeat:50}),Oe({minScore:80,limit:50}),ze({minCountries:2,maxHours:1})]);r(s),f(l),z(m),ne(v),oe(Z),ae(_e),ce(fe),le(ve),de(we)}catch(s){d(s.message)}finally{h(!1)}},j=s=>new Intl.NumberFormat().format(s||0),M=s=>{const m={search_engine:{color:"success",label:"Search Engine"},social_media:{color:"info",label:"Social Media"},monitoring:{color:"primary",label:"Monitoring"},automation:{color:"warning",label:"Automation"},scraper:{color:"danger",label:"Scraper"},generic_bot:{color:"secondary",label:"Generic Bot"},suspicious_short:{color:"warning",label:"Suspicious"},empty_ua:{color:"danger",label:"Empty UA"}}[s]||{color:"dark",label:"Unknown"};return e.jsx(g,{color:m.color,children:m.label})},pe=s=>s>=90?e.jsx(g,{color:"danger",children:"High"}):s>=70?e.jsx(g,{color:"warning",children:"Medium"}):e.jsx(g,{color:"info",children:"Low"}),T=(s,l=60)=>!s||s.length<=l?s||"[EMPTY]":s.substring(0,l)+"...",Q=async s=>{B(!0),O("Detailed Records for User Agent"),H(!0),b([]);try{const l=await Fe(s,{limit:50});b(l)}catch(l){console.error("Error fetching detailed records:",l),b([])}finally{B(!1)}},X=async s=>{B(!0),O(`Detailed Records for Session: ${s.substring(0,8)}...`),H(!0),b([]);try{const l=await We(s);b(l)}catch(l){console.error("Error fetching detailed records:",l),b([])}finally{B(!1)}},me=async s=>{B(!0),O(`Detailed Records for Visitor: ${s.substring(0,8)}...`),H(!0),b([]);try{const l=await $e(s,{limit:50});b(l)}catch(l){console.error("Error fetching detailed records:",l),b([])}finally{B(!1)}},ge=async(s,l,m=null)=>{B(!0),O(`Detailed Records for IP: ${s}`),H(!0),b([]);try{const v=await Ge(s,l,m,{limit:50});b(v)}catch(v){console.error("Error fetching detailed records:",v),b([])}finally{B(!1)}};if(u)return e.jsx("div",{className:"text-center p-5",children:e.jsx(te,{color:"primary"})});if(a)return e.jsxs(y,{color:"danger",children:["Error loading bot analytics: ",a]});const je=t.search_engine_bots+t.social_media_bots+t.monitoring_bots+t.automation_tools+t.scrapers+t.suspicious;return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsx("h1",{children:"Bot Detection Dashboard"}),e.jsxs(re,{color:"primary",onClick:se,children:[e.jsx(P,{icon:Me,className:"me-2"}),"Refresh"]})]}),e.jsxs(ie,{className:"mb-4",children:[e.jsx(V,{sm:6,lg:3,children:e.jsx(I,{className:"mb-4",children:e.jsx(E,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-medium-emphasis small",children:"Total Requests"}),e.jsx("div",{className:"fs-4 fw-semibold",children:j(t.total_requests)})]}),e.jsx(P,{icon:be,size:"xl",className:"text-primary"})]})})})}),e.jsx(V,{sm:6,lg:3,children:e.jsx(I,{className:"mb-4",children:e.jsx(E,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-medium-emphasis small",children:"Human Traffic"}),e.jsxs("div",{className:"fs-4 fw-semibold",children:[j(t.human_traffic),e.jsxs("span",{className:"fs-6 text-success ms-2",children:["(",t.human_percentage,"%)"]})]})]}),e.jsx(P,{icon:De,size:"xl",className:"text-success"})]})})})}),e.jsx(V,{sm:6,lg:3,children:e.jsx(I,{className:"mb-4",children:e.jsx(E,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-medium-emphasis small",children:"Bot Traffic"}),e.jsxs("div",{className:"fs-4 fw-semibold",children:[j(je),e.jsxs("span",{className:"fs-6 text-danger ms-2",children:["(",t.bot_percentage,"%)"]})]})]}),e.jsx(P,{icon:Ae,size:"xl",className:"text-danger"})]})})})}),e.jsx(V,{sm:6,lg:3,children:e.jsx(I,{className:"mb-4",children:e.jsx(E,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-medium-emphasis small",children:"Suspicious Activity"}),e.jsx("div",{className:"fs-4 fw-semibold",children:j(t.automation_tools+t.scrapers)})]}),e.jsx(P,{icon:Ie,size:"xl",className:"text-warning"})]})})})})]}),e.jsxs(ie,{className:"mb-4",children:[e.jsx(V,{lg:6,children:e.jsxs(I,{children:[e.jsxs(ee,{children:[e.jsx(P,{icon:Pe,className:"me-2"}),e.jsx("strong",{children:"Bot Traffic Breakdown"})]}),e.jsxs(E,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsxs("span",{children:["Search Engines ",e.jsx(g,{color:"success",children:"Legitimate"})]}),e.jsx("span",{className:"text-medium-emphasis",children:j(t.search_engine_bots)})]}),e.jsx(U,{thin:!0,children:e.jsx(L,{color:"success",value:t.search_engine_bots/t.total_requests*100})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsxs("span",{children:["Social Media ",e.jsx(g,{color:"info",children:"Legitimate"})]}),e.jsx("span",{className:"text-medium-emphasis",children:j(t.social_media_bots)})]}),e.jsx(U,{thin:!0,children:e.jsx(L,{color:"info",value:t.social_media_bots/t.total_requests*100})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsxs("span",{children:["Monitoring Services ",e.jsx(g,{color:"primary",children:"Legitimate"})]}),e.jsx("span",{className:"text-medium-emphasis",children:j(t.monitoring_bots)})]}),e.jsx(U,{thin:!0,children:e.jsx(L,{color:"primary",value:t.monitoring_bots/t.total_requests*100})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsxs("span",{children:["Automation Tools ",e.jsx(g,{color:"warning",children:"Suspicious"})]}),e.jsx("span",{className:"text-medium-emphasis",children:j(t.automation_tools)})]}),e.jsx(U,{thin:!0,children:e.jsx(L,{color:"warning",value:t.automation_tools/t.total_requests*100})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsxs("span",{children:["Scrapers ",e.jsx(g,{color:"danger",children:"Malicious"})]}),e.jsx("span",{className:"text-medium-emphasis",children:j(t.scrapers)})]}),e.jsx(U,{thin:!0,children:e.jsx(L,{color:"danger",value:t.scrapers/t.total_requests*100})})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsxs("span",{children:["Other Suspicious ",e.jsx(g,{color:"secondary",children:"Unknown"})]}),e.jsx("span",{className:"text-medium-emphasis",children:j(t.suspicious)})]}),e.jsx(U,{thin:!0,children:e.jsx(L,{color:"secondary",value:t.suspicious/t.total_requests*100})})]})]})]})}),e.jsx(V,{lg:6,children:e.jsxs(I,{children:[e.jsx(ee,{children:e.jsx("strong",{children:"Top Bot User Agents"})}),e.jsx(E,{children:e.jsxs(C,{hover:!0,small:!0,responsive:!0,children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(o,{children:"User Agent"}),e.jsx(o,{children:"Count"})]})}),e.jsxs(k,{children:[Object.entries(t.breakdown).sort(([,s],[,l])=>l.count-s.count).slice(0,10).map(([s,l])=>e.jsxs(p,{children:[e.jsx(i,{children:e.jsxs("div",{className:"d-flex align-items-center",children:[M(l.botType),e.jsx("small",{className:"ms-2 text-truncate",style:{maxWidth:"300px"},children:T(s,40)})]})}),e.jsx(i,{children:j(l.count)})]},s)),Object.keys(t.breakdown).length===0&&e.jsx(p,{children:e.jsx(i,{colSpan:2,className:"text-center text-medium-emphasis",children:"No bot data available"})})]})]})})]})})]}),e.jsxs(I,{className:"mb-4",children:[e.jsx(ee,{children:e.jsx("strong",{children:"Detection Details"})}),e.jsxs(E,{children:[e.jsxs(ye,{variant:"tabs",role:"tablist",children:[e.jsx(D,{children:e.jsxs(A,{active:n==="overview",onClick:()=>c("overview"),style:{cursor:"pointer"},children:["Known Bots (",x.length,")"]})}),e.jsx(D,{children:e.jsxs(A,{active:n==="automation",onClick:()=>c("automation"),style:{cursor:"pointer"},children:["Automation (",S.length,")"]})}),e.jsx(D,{children:e.jsxs(A,{active:n==="suspicious",onClick:()=>c("suspicious"),style:{cursor:"pointer"},children:["Suspicious UA (",F.length,")"]})}),e.jsx(D,{children:e.jsxs(A,{active:n==="speed",onClick:()=>c("speed"),style:{cursor:"pointer"},children:["Fast Sessions (",W.length,")"]})}),e.jsx(D,{children:e.jsxs(A,{active:n==="bounces",onClick:()=>c("bounces"),style:{cursor:"pointer"},children:["Instant Bounces (",$.length,")"]})}),e.jsx(D,{children:e.jsxs(A,{active:n==="repetitive",onClick:()=>c("repetitive"),style:{cursor:"pointer"},children:["Repetitive (",G.length,")"]})}),e.jsx(D,{children:e.jsxs(A,{active:n==="scores",onClick:()=>c("scores"),style:{cursor:"pointer"},children:["Bot Scores (",Y.length,")"]})}),e.jsx(D,{children:e.jsxs(A,{active:n==="geo",onClick:()=>c("geo"),style:{cursor:"pointer"},children:["Geo Anomalies (",K.length,")"]})})]}),e.jsxs(Ce,{className:"mt-3",children:[e.jsxs(q,{visible:n==="overview",children:[e.jsxs(y,{color:"info",className:"mb-3",children:[e.jsx("strong",{children:"Known Bots Detection:"})," Identifies traffic from user agents matching known bot patterns including search engines (Google, Bing), social media crawlers (Facebook, Twitter), and scraping tools. These are detected by analyzing user agent strings against a database of known bot signatures."]}),e.jsxs(C,{hover:!0,responsive:!0,children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(o,{children:"User Agent"}),e.jsx(o,{children:"Type"}),e.jsx(o,{children:"Count"}),e.jsx(o,{children:"Unique IPs"}),e.jsx(o,{children:"Sessions"}),e.jsx(o,{children:"Confidence"})]})}),e.jsxs(k,{children:[x.map((s,l)=>e.jsxs(p,{onClick:()=>Q(s.user_agent),style:{cursor:"pointer"},title:"Click to view detailed records",children:[e.jsx(i,{children:e.jsx("small",{className:"text-truncate d-block",style:{maxWidth:"300px"},children:T(s.user_agent)})}),e.jsx(i,{children:M(s.detection.botType)}),e.jsx(i,{children:j(s.count)}),e.jsx(i,{children:j(s.unique_ips)}),e.jsx(i,{children:j(s.unique_sessions)}),e.jsx(i,{children:pe(s.detection.confidence)})]},l)),x.length===0&&e.jsx(p,{children:e.jsx(i,{colSpan:6,className:"text-center text-medium-emphasis",children:"No known bots detected"})})]})]})]}),e.jsxs(q,{visible:n==="automation",children:[e.jsxs(y,{color:"warning",className:"mb-3",children:[e.jsx("strong",{children:"Automation Tools Detection:"})," Detects headless browsers and automation frameworks like Selenium, Puppeteer, Playwright, and PhantomJS. These tools are commonly used for web scraping, automated testing, or malicious bot activity. High detection confidence indicates suspicious automated access."]}),e.jsxs(C,{hover:!0,responsive:!0,children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(o,{children:"User Agent"}),e.jsx(o,{children:"Session ID"}),e.jsx(o,{children:"IP Address"}),e.jsx(o,{children:"Page Type"}),e.jsx(o,{children:"Application Source"}),e.jsx(o,{children:"Timestamp"})]})}),e.jsxs(k,{children:[S.map((s,l)=>{var m;return e.jsxs(p,{onClick:()=>X(s.session_id),style:{cursor:"pointer"},title:"Click to view detailed records for this session",children:[e.jsx(i,{children:e.jsx("small",{className:"text-truncate d-block",style:{maxWidth:"300px"},children:T(s.user_agent)})}),e.jsx(i,{children:e.jsxs("small",{className:"font-monospace",children:[(m=s.session_id)==null?void 0:m.substring(0,8),"..."]})}),e.jsx(i,{children:s.ip_address}),e.jsx(i,{children:e.jsx(g,{color:"info",children:s.page_type})}),e.jsx(i,{children:e.jsx(g,{color:"info",children:s.application_source})}),e.jsx(i,{children:e.jsx("small",{children:new Date(s.viewed_at).toLocaleString()})})]},l)}),S.length===0&&e.jsx(p,{children:e.jsx(i,{colSpan:5,className:"text-center text-medium-emphasis",children:"No automation tools detected"})})]})]})]}),e.jsxs(q,{visible:n==="suspicious",children:[e.jsxs(y,{color:"warning",className:"mb-3",children:[e.jsx("strong",{children:"Suspicious User Agents Detection:"})," Flags unusually short (less than 20 characters) or empty user agent strings. Legitimate browsers typically have detailed user agent strings, while bots often use simplified or missing values. This can indicate spoofed requests or basic scraping scripts."]}),e.jsxs(C,{hover:!0,responsive:!0,children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(o,{children:"User Agent"}),e.jsx(o,{children:"Count"}),e.jsx(o,{children:"Unique IPs"})]})}),e.jsxs(k,{children:[F.map((s,l)=>e.jsxs(p,{onClick:()=>Q(s.user_agent),style:{cursor:"pointer"},title:"Click to view detailed records",children:[e.jsx(i,{children:e.jsx("small",{className:"text-truncate d-block",style:{maxWidth:"400px"},children:T(s.user_agent,80)})}),e.jsx(i,{children:j(s.count)}),e.jsx(i,{children:j(s.unique_ips)})]},l)),F.length===0&&e.jsx(p,{children:e.jsx(i,{colSpan:3,className:"text-center text-medium-emphasis",children:"No suspicious user agents detected"})})]})]})]}),e.jsxs(q,{visible:n==="speed",children:[e.jsxs(y,{color:"danger",className:"mb-3",children:[e.jsx("strong",{children:"Superhuman Speed Detection:"})," Identifies sessions with impossibly fast page navigation (5+ pages in less than 10 seconds). Human users cannot browse this quickly, indicating automated bot activity. High pages-per-second ratios are strong indicators of scraping or crawling behavior."]}),e.jsxs(C,{hover:!0,responsive:!0,children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(o,{children:"Session ID"}),e.jsx(o,{children:"User Agent"}),e.jsx(o,{children:"Page Count"}),e.jsx(o,{children:"Duration (s)"}),e.jsx(o,{children:"Pages/Sec"}),e.jsx(o,{children:"Detection"})]})}),e.jsxs(k,{children:[W.map((s,l)=>{var m,v;return e.jsxs(p,{onClick:()=>X(s.session_id),style:{cursor:"pointer"},title:"Click to view detailed records for this session",children:[e.jsx(i,{children:e.jsxs("small",{className:"font-monospace",children:[(m=s.session_id)==null?void 0:m.substring(0,8),"..."]})}),e.jsx(i,{children:e.jsx("small",{className:"text-truncate d-block",style:{maxWidth:"250px"},children:T(s.user_agent,50)})}),e.jsx(i,{children:s.page_count}),e.jsx(i,{children:e.jsx(g,{color:"danger",children:s.duration_seconds.toFixed(2)})}),e.jsx(i,{children:e.jsx(g,{color:"warning",children:s.pages_per_second.toFixed(2)})}),e.jsx(i,{children:(v=s.detection)!=null&&v.isBot?M(s.detection.botType):"-"})]},l)}),W.length===0&&e.jsx(p,{children:e.jsx(i,{colSpan:6,className:"text-center text-medium-emphasis",children:"No superfast sessions detected"})})]})]})]}),e.jsxs(q,{visible:n==="bounces",children:[e.jsxs(y,{color:"danger",className:"mb-3",children:[e.jsx("strong",{children:"Instant Bounces Detection:"})," Tracks user agents with extremely low time-on-page values (less than 2 seconds average across 10+ page views). Bots often spend zero or minimal time on pages since they don't need to read content. Real users typically spend several seconds per page."]}),e.jsxs(C,{hover:!0,responsive:!0,children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(o,{children:"User Agent"}),e.jsx(o,{children:"Count"}),e.jsx(o,{children:"Avg Time (s)"}),e.jsx(o,{children:"Detection"})]})}),e.jsxs(k,{children:[$.map((s,l)=>{var m;return e.jsxs(p,{onClick:()=>Q(s.user_agent),style:{cursor:"pointer"},title:"Click to view detailed records",children:[e.jsx(i,{children:e.jsx("small",{className:"text-truncate d-block",style:{maxWidth:"350px"},children:T(s.user_agent)})}),e.jsx(i,{children:j(s.count)}),e.jsx(i,{children:e.jsx(g,{color:"danger",children:s.avg_time.toFixed(2)})}),e.jsx(i,{children:(m=s.detection)!=null&&m.isBot?M(s.detection.botType):"-"})]},l)}),$.length===0&&e.jsx(p,{children:e.jsx(i,{colSpan:4,className:"text-center text-medium-emphasis",children:"No instant bounces detected"})})]})]})]}),e.jsxs(q,{visible:n==="repetitive",children:[e.jsxs(y,{color:"warning",className:"mb-3",children:[e.jsx("strong",{children:"Repetitive Access Patterns Detection:"})," Detects when the same IP address and user agent combination accesses the same page type 50+ times. This pattern is typical of scrapers systematically harvesting data or bots monitoring specific pages. Legitimate users rarely exhibit such repetitive behavior."]}),e.jsxs(C,{hover:!0,responsive:!0,children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(o,{children:"IP Address"}),e.jsx(o,{children:"User Agent"}),e.jsx(o,{children:"Page Type"}),e.jsx(o,{children:"Repeat Count"}),e.jsx(o,{children:"Detection"})]})}),e.jsxs(k,{children:[G.map((s,l)=>{var m;return e.jsxs(p,{onClick:()=>ge(s.ip_address,s.user_agent,s.page_type),style:{cursor:"pointer"},title:"Click to view detailed records for this IP and User Agent",children:[e.jsx(i,{children:s.ip_address}),e.jsx(i,{children:e.jsx("small",{className:"text-truncate d-block",style:{maxWidth:"250px"},children:T(s.user_agent,50)})}),e.jsx(i,{children:e.jsx(g,{color:"info",children:s.page_type})}),e.jsx(i,{children:e.jsx(g,{color:"danger",children:j(s.repeat_count)})}),e.jsx(i,{children:(m=s.detection)!=null&&m.isBot?M(s.detection.botType):"-"})]},l)}),G.length===0&&e.jsx(p,{children:e.jsx(i,{colSpan:5,className:"text-center text-medium-emphasis",children:"No repetitive patterns detected"})})]})]})]}),e.jsxs(q,{visible:n==="scores",children:[e.jsxs(y,{color:"info",className:"mb-3",children:[e.jsx("strong",{children:"Multi-Signal Bot Scoring:"})," Combines multiple detection signals (user agent patterns, time-on-page, referrer, view count) into a single bot probability score. Scores: 80-100 = Likely bot, 100-150 = High confidence bot, 150+ = Definitely bot. This comprehensive approach reduces false positives by considering behavioral context."]}),e.jsxs(C,{hover:!0,responsive:!0,children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(o,{children:"Session ID"}),e.jsx(o,{children:"User Agent"}),e.jsx(o,{children:"IP Address"}),e.jsx(o,{children:"Views"}),e.jsx(o,{children:"Avg Time"}),e.jsx(o,{children:"Bot Score"}),e.jsx(o,{children:"Detection"})]})}),e.jsxs(k,{children:[Y.map((s,l)=>{var m,v;return e.jsxs(p,{onClick:()=>X(s.session_id),style:{cursor:"pointer"},title:"Click to view detailed records for this session",children:[e.jsx(i,{children:e.jsxs("small",{className:"font-monospace",children:[(m=s.session_id)==null?void 0:m.substring(0,8),"..."]})}),e.jsx(i,{children:e.jsx("small",{className:"text-truncate d-block",style:{maxWidth:"200px"},children:T(s.user_agent,40)})}),e.jsx(i,{children:s.ip_address}),e.jsx(i,{children:s.view_count}),e.jsxs(i,{children:[s.avg_time_on_page.toFixed(1),"s"]}),e.jsx(i,{children:e.jsx(g,{color:s.bot_score>=150?"danger":s.bot_score>=100?"warning":"info",children:s.bot_score})}),e.jsx(i,{children:(v=s.detection)!=null&&v.isBot?M(s.detection.botType):"-"})]},l)}),Y.length===0&&e.jsx(p,{children:e.jsx(i,{colSpan:7,className:"text-center text-medium-emphasis",children:"No high bot scores detected"})})]})]})]}),e.jsxs(q,{visible:n==="geo",children:[e.jsxs(y,{color:"danger",className:"mb-3",children:[e.jsx("strong",{children:"Geographic Impossibilities Detection:"})," Identifies visitors accessing the site from multiple countries within a short time window (2+ countries in less than 1 hour). This is physically impossible for real users and indicates IP spoofing, VPN switching, or distributed bot networks. Strong indicator of malicious activity."]}),e.jsxs(C,{hover:!0,responsive:!0,children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(o,{children:"Visitor ID"}),e.jsx(o,{children:"User Agent"}),e.jsx(o,{children:"Countries"}),e.jsx(o,{children:"Time Span (hrs)"}),e.jsx(o,{children:"Detection"})]})}),e.jsxs(k,{children:[K.map((s,l)=>{var m,v;return e.jsxs(p,{onClick:()=>me(s.visitor_id),style:{cursor:"pointer"},title:"Click to view detailed records for this visitor",children:[e.jsx(i,{children:e.jsxs("small",{className:"font-monospace",children:[(m=s.visitor_id)==null?void 0:m.substring(0,8),"..."]})}),e.jsx(i,{children:e.jsx("small",{className:"text-truncate d-block",style:{maxWidth:"250px"},children:T(s.user_agent,50)})}),e.jsx(i,{children:s.countries_visited.map(Z=>e.jsx(g,{color:"warning",className:"me-1",children:Z},Z))}),e.jsx(i,{children:e.jsx(g,{color:"danger",children:s.time_span_hours})}),e.jsx(i,{children:(v=s.detection)!=null&&v.isBot?M(s.detection.botType):"-"})]},l)}),K.length===0&&e.jsx(p,{children:e.jsx(i,{colSpan:5,className:"text-center text-medium-emphasis",children:"No geographic anomalies detected"})})]})]})]})]})]})]}),e.jsxs(Ne,{fullscreen:!0,size:"xl",visible:he,onClose:()=>H(!1),scrollable:!0,children:[e.jsx(ke,{children:e.jsxs(Se,{children:[e.jsx(P,{icon:qe,className:"me-2"}),ue]})}),e.jsx(Te,{children:xe?e.jsx("div",{className:"text-center p-4",children:e.jsx(te,{color:"primary"})}):J.length>0?e.jsxs("div",{children:[e.jsxs(y,{color:"info",className:"mb-3",children:[e.jsx("strong",{children:J.length})," record(s) found"]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs(C,{hover:!0,small:!0,responsive:!0,striped:!0,children:[e.jsx(N,{children:e.jsxs(p,{children:[e.jsx(o,{style:{minWidth:"280px"},children:"ID"}),e.jsx(o,{children:"Session ID"}),e.jsx(o,{children:"Visitor ID"}),e.jsx(o,{children:"Page Type"}),e.jsx(o,{children:"Application Source"}),e.jsx(o,{children:"IP Address"}),e.jsx(o,{children:"Country"}),e.jsx(o,{children:"City / Region"}),e.jsx(o,{children:"Device"}),e.jsx(o,{children:"Browser"}),e.jsx(o,{children:"OS"}),e.jsx(o,{style:{minWidth:"250px"},children:"User Agent"}),e.jsx(o,{children:"Referrer"}),e.jsx(o,{children:"Time on Page"}),e.jsx(o,{children:"Timestamp"})]})}),e.jsx(k,{children:J.map(s=>e.jsxs(p,{children:[e.jsx(i,{children:e.jsx("small",{className:"font-monospace",style:{wordBreak:"break-all"},children:s.id||"-"})}),e.jsx(i,{children:e.jsx("small",{className:"font-monospace",style:{wordBreak:"break-all"},children:s.session_id||"-"})}),e.jsx(i,{children:e.jsx("small",{className:"font-monospace",style:{wordBreak:"break-all"},children:s.visitor_id||"-"})}),e.jsx(i,{children:e.jsx(g,{color:"info",children:s.page_type||"-"})}),e.jsx(i,{children:e.jsx(g,{color:"info",children:s.application_source||"-"})}),e.jsx(i,{children:s.ip_address||"-"}),e.jsx(i,{children:s.country_code?e.jsxs("div",{children:[e.jsx("strong",{children:s.country_code}),e.jsx("br",{}),e.jsx("small",{children:s.country_name})]}):"-"}),e.jsx(i,{children:s.city&&s.region?e.jsxs("div",{children:[e.jsx("strong",{children:s.city}),e.jsx("br",{}),e.jsx("small",{children:s.region})]}):s.city||s.region||"-"}),e.jsx(i,{children:e.jsx(g,{color:"secondary",children:s.device_type||"-"})}),e.jsx(i,{children:s.browser||"-"}),e.jsx(i,{children:s.os||"-"}),e.jsx(i,{children:e.jsx("small",{style:{wordBreak:"break-word"},children:s.user_agent||"-"})}),e.jsx(i,{children:e.jsx("small",{style:{wordBreak:"break-word"},children:s.referrer||"-"})}),e.jsx(i,{children:s.time_on_page!==null?`${s.time_on_page}s`:"-"}),e.jsx(i,{style:{minWidth:"150px"},children:e.jsx("small",{children:new Date(s.viewed_at).toLocaleString()})})]},s.id))})]})})]}):e.jsx(y,{color:"warning",children:"No detailed records found"})}),e.jsx(Be,{children:e.jsx(re,{color:"secondary",onClick:()=>H(!1),children:"Close"})})]})]})};export{ls as default};
